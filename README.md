# MiniMax
The MiniMax tool searches for groups of several enriched transcription factor binding site (TFBS) motifs in the large library of TFBS motifs derived from public databases of motifs, this library can be complemented by other motifs obtained by _de novo_ motif search. The enrichment is estimated in the comparison of the given positive and negative sequence set. The tool is designed for analysis of RNA-seq and ChIP-seq data. Hence, the positive/negative sequences are promoters of differentially expressed genes (DEGs) / not DEGs, and ChIP-seq peaks and randomly selected genomic loci. 

# Description
Basic computation principle of the MiniMax tool comes from the [MetArea tool](https://github.com/parthian-sterlet/metarea). For a motif representing TFBSs, the recognition accuracy is calculated as the partial area under PR curve (pAUPRC, [Levitsky et al., 2024](https://doi.org/10.18699/vjgb-24-90); [Davis, Goadrich, 2006](https://doi.org/10.1145/1143844.1143874)). The term PR means the Precision-Recall curve. Several PR curves and their pAUPRC values compiles a group of motifs. For this group for any DNA sequence certain motif of this group with the best hit among other motifs of this group defines the hit of the whole group, i.e. different motifs may represent group in various sequences. Hence, we can search the groups that better in terms of the pAUPRC measure discriminates the positive and negative sequence sets. Testing and optimizarion of motif content for the population of many groups by the approach of genetic algorithm (GA) allows to detect and to rank the group of motifs that are the better reflect the diference between two sequence sets. The motifs of the same group can represent either structurally different binding sites for the same TF, or binding sites of different TFs acting as part of a single multi-protein complex (Levitsky et al., [2014](https://doi.org/10.1186/1471-2164-15-80), [2024](https://doi.org/10.18699/vjgb-24-90)). Since the default option of TFs action is mutual cooperative interactions ([Morgunova & Taipale, 2017](https://doi.org/10.1016/j.sbi.2017.03.006)), the single protein complex of multiple TFs is reflected in various portions of peaks as different enriched motifs of various TFs, including TFs participating in transcription regulation of DEGs from the RNA-seq data, and the target and partner TFs related to TFBS motif enrichment for RNA-seq or ChIP-seq data. Hence, the functional relationship of these distinct motifs is recognized through increased recognition performance in groups of enriched motifs compared to other groups of the same number of motifs. Thus, MiniMax predicts TFBS motifs respecting TFs paricipating in the same multiprotein complexes functioning in gene transcription regulation.

# Algorithm, input and output data
MiniMax algorithm considers a pair of positive/negative sequence sets derived either from from RNA-seq or ChIP-seq data. peaks. For RNA-seq data the positive and negative sequences are promoters of DEGs and not-DEGs, that are defined by the criteria {adjusted p-value < 0.05 & log2(FoldChange) > 1 / log2(FoldChange) < -1  for up-/down-regulated DEGs} and {adjusted p-value > 0.05 & 0.8 < FoldChange) < 1.25}, correspondingly. For ChIP-seq data the positive/negative sequences are ChIP-seq peaksor randomly selected genomic loci, correspondingly. In the case if RNA-seq data, the , respectively. For ChIP-seq/ATAC-seq data the negative set contains [randomly selected genomic loci, adopted by G/C-content selected by the AntiNoise tool](https://github.com/parthian-sterlet/antinoise/). 

GA input data:
- a pair of positive/negative sets, containg Npos/Nneg sequences;
- a library of Mtot TFBS motifs derived from public databases like [Hocomoco](https://hocomoco14.autosome.org/) ([Vorontsov et al., 2024](https://doi.org/10.1093/nar/gkad1077)) or [Jaspar](https://jaspar.elixir.no/) ([Rauluseviciute et al., 2024](https://doi.org/10.1093/nar/gkad1059)), this library can be complemented by motifs derived by _de novo_ motifs search for an apropriate dataset, for each motifs it is required its name (e.g. TF name and motif designation) and short sescription of its TF class/family according to the hierarchical classification of mammalian ([Wingender et al., 2018](https://doi.org/10.1093/nar/gkx987)) and plant ([Blanc-Mathieu et al., 2024](https://doi.org/10.1016/j.tplants.2023.06.023)) TFs by DNA-binding domain (DBD) structure;
- two matrices of the sizes Mtot x Npos and Mtot x Nbeg. The rows of these matrices represent sequences (1 ≤ n ≤ Npos, 1 ≤ n ≤ Nneg). The m-th column (1 ≤ m ≤ Mtot) of these matrices contain -Log<sub>10</sub>(ERR) values (Expected Recognition Rate, ERR) for best predicted hits of m-th motif in the respective sequence set ([Tsukanov et al., 2022](https://doi.org/10.3389/fpls.2022.938545)). 

GA obtains for these input data the list of motif groups ranked by pAUPRC accuracy, each group includes exactly M motifs, M < Mtot.

GA output data:
- a list of elite (top-scored) ME motif groups ranked in the descending order of their pAUPRC recognition accuracy. For the group of one motifs (single motifs), the elite includes all motifs of the input library, otherwise, the default size of the elite is 100 motifs.
- a list of PR curves for ME motif groups, the list is also ranked in the descending order of the pAUPRC values;
- internal structure of motif groups, a list of triangle matrices for ME motif groups, computed separately for positive and negative sequence sets, each matrix contains M × (M - 1) / 2 Pearson's correlation coefficients for various pairs of -Log<sub>10</sub>(ERR) vectors representing separate motifs of the same group, the list of matrices is ranked in the descending order of the pAUPRC values;
- external structure of motif groups, two triangle matrices for all elite motifs computed separately for positive and negative sequence sets, each matrix contains ME × (ME - 1) / 2 Pearson's correlation coefficients for various pairs of -Log<sub>10</sub>(ERR) vectors representing the elite groups. 

# Source code and command line arguments

# Command line examples
